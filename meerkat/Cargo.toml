[package]
name = "meerkat"
description = "Modular, high-performance agent harness for LLM-powered applications"
version.workspace = true
edition.workspace = true
rust-version.workspace = true
license.workspace = true
authors.workspace = true
repository.workspace = true
homepage.workspace = true
documentation.workspace = true
keywords.workspace = true
categories.workspace = true

[dependencies]
meerkat-core = { workspace = true }
meerkat-client = { workspace = true }
meerkat-store = { workspace = true }
meerkat-tools = { workspace = true }
meerkat-session = { workspace = true }
meerkat-memory = { workspace = true, optional = true }
meerkat-mcp = { workspace = true, optional = true }
meerkat-comms = { workspace = true, optional = true }
meerkat-hooks = { workspace = true }
meerkat-contracts = { workspace = true }
meerkat-skills = { workspace = true, optional = true }
tokio = { workspace = true }
async-trait = { workspace = true }
serde_json = { workspace = true }
futures = { workspace = true }
thiserror = { workspace = true }
tracing = { workspace = true }

[dev-dependencies]
tempfile = { workspace = true }
tokio = { workspace = true, features = ["test-util", "macros"] }
serde = { workspace = true }
serde_json = { workspace = true }
toml = { workspace = true }
futures = { workspace = true }
async-trait = { workspace = true }
schemars = { workspace = true }
which = { workspace = true }
# meerkat-mcp-server is NOT a dependency â€” it depends on us (no circular dep).
# Binaries (rkat, meerkat-rest) depend on it directly.

[target.'cfg(unix)'.dev-dependencies]
nix = { workspace = true }

[features]
default = ["anthropic", "jsonl-store", "comms", "mcp", "sub-agents", "skills"]
integration-real-tests = []

# LLM providers
anthropic = ["meerkat-client/anthropic"]
openai = ["meerkat-client/openai"]
gemini = ["meerkat-client/gemini"]
all-providers = ["anthropic", "openai", "gemini"]

# Storage backends
jsonl-store = ["meerkat-store/jsonl"]
memory-store = ["meerkat-store/memory"]

# Session capabilities
session-store = ["meerkat-session/session-store"]
session-compaction = ["meerkat-session/session-compaction"]
memory-store-session = ["dep:meerkat-memory"]

# Optional subsystems
comms = ["dep:meerkat-comms", "meerkat-tools/comms"]
mcp = ["dep:meerkat-mcp", "meerkat-tools/mcp"]
sub-agents = ["meerkat-tools/sub-agents"]
skills = ["dep:meerkat-skills", "meerkat-tools/skills"]

[lints]
workspace = true

[[example]]
name = "comms_verbose"
path = "examples/comms_verbose.rs"
required-features = ["comms"]

[[test]]
name = "e2e"
path = "tests/e2e.rs"
required-features = ["integration-real-tests"]

[[test]]
name = "e2e_comms"
path = "tests/e2e_comms.rs"
required-features = ["integration-real-tests"]

[[test]]
name = "e2e_shell"
path = "tests/e2e_shell.rs"
required-features = ["integration-real-tests"]

[[test]]
name = "e2e_smoke"
path = "tests/e2e_smoke.rs"
required-features = ["integration-real-tests"]
